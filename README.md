# üè• MedTech Backend API

[![Backend CI/CD](https://github.com/yourusername/medtech/actions/workflows/backend-ci-cd.yml/badge.svg)](https://github.com/yourusername/medtech/actions/workflows/backend-ci-cd.yml)
[![codecov](https://codecov.io/gh/yourusername/medtech/graph/badge.svg?token=YOUR_TOKEN)](https://codecov.io/gh/yourusername/medtech)
[![Python](https://img.shields.io/badge/python-3.13-blue.svg)](https://www.python.org/downloads/)
[![FastAPI](https://img.shields.io/badge/FastAPI-0.104.1-009688.svg?style=flat&logo=FastAPI&logoColor=white)](https://fastapi.tiangolo.com)
[![Tests](https://img.shields.io/badge/tests-40%20passed-success.svg)](./tests/)
[![Coverage](https://img.shields.io/badge/coverage-48%25-yellow.svg)](./htmlcov/)

> –°–∏—Å—Ç–µ–º–∞ –∞–Ω–∞–ª–∏–∑–∞ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π –∫—Ä–æ–≤–∏ —Å —Ä–∞—Å—á–µ—Ç–æ–º SII (Systemic Immune-Inflammation Index)

## üöÄ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- **üî¨ –†–∞—Å—á–µ—Ç SII** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á–µ—Ç –∏–Ω–¥–µ–∫—Å–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤–æ—Å–ø–∞–ª–µ–Ω–∏—è
- **üè• –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–π** - –ò–Ω–≤–∏—Ç—Ä–æ, –û–ª–∏–º–ø, InVivo
- **üìÑ –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤** - PDF –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —á–µ—Ä–µ–∑ AWS Textract
- **ü©∫ –¢–∏–ø—ã —Ä–∞–∫–∞** - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö ICD-10 –∫–æ–¥–æ–≤
- **‚ö° –ë—ã—Å—Ç—Ä—ã–π API** - FastAPI —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π
- **üõ°Ô∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
- **üå°Ô∏è –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - —ç–Ω–¥–ø–æ–∏–Ω—Ç –∑–¥–æ—Ä–æ–≤—å—è —Å–∏—Å—Ç–µ–º—ã

## üìä –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### üèóÔ∏è –ú–æ–¥—É–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:
```
src/
‚îú‚îÄ‚îÄ api/           # API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
‚îú‚îÄ‚îÄ services/      # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îú‚îÄ‚îÄ core/          # –ò—Å–∫–ª—é—á–µ–Ω–∏—è –∏ –±–∞–∑–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã
‚îú‚îÄ‚îÄ schemas/       # Pydantic –º–æ–¥–µ–ª–∏
‚îú‚îÄ‚îÄ middlewares.py # –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–µ –ü–û
‚îî‚îÄ‚îÄ main.py        # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```

### üîÑ –°–µ—Ä–≤–∏—Å—ã:
- **SIICalculator** - —Ä–∞—Å—á–µ—Ç –∏–Ω–¥–µ–∫—Å–∞ SII
- **DocumentProcessor** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- **LabParsers** - –ø–∞—Ä—Å–µ—Ä—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–π

## üõ†Ô∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- Python 3.13+
- AWS –∞–∫–∫–∞—É–Ω—Ç (–¥–ª—è Textract OCR)

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞:

```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
git clone https://github.com/yourusername/medtech.git
cd medtech/backend

# –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
python -m venv .venv
source .venv/bin/activate  # Linux/Mac
# –∏–ª–∏ .venv\Scripts\activate  # Windows

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install -r requirements.txt

# –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
uvicorn src.main:app --reload --host 0.0.0.0 --port 8000
```

### üê≥ Docker:

```bash
# –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞
docker build -t medtech-backend .

# –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker run -p 8000:8000 medtech-backend
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤:

```bash
# –í—Å–µ —Ç–µ—Å—Ç—ã
pytest tests/ -v

# –° –ø–æ–∫—Ä—ã—Ç–∏–µ–º
pytest tests/ --cov=src --cov-report=html --cov-report=term-missing

# –ü–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º
pytest tests/test_blood_results_controller_updated.py -v  # API —Ç–µ—Å—Ç—ã
pytest tests/test_interpret_sii_unit.py -v                # Unit —Ç–µ—Å—Ç—ã SII
pytest tests/test_blood_parser.py -v                      # –ü–∞—Ä—Å–µ—Ä—ã
```

### üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç–µ—Å—Ç–æ–≤:
- **–í—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤:** 40
- **–£—Å–ø–µ—à–Ω—ã—Ö:** 40 ‚úÖ (100%)
- **–ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞:** 48%
- **–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~0.07 —Å–µ–∫—É–Ω–¥—ã

## üìñ API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å–∞–º:
- **Swagger UI:** http://localhost:8000/docs
- **ReDoc:** http://localhost:8000/redoc

### üîó –û—Å–Ω–æ–≤–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã:

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| `GET` | `/` | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± API |
| `GET` | `/health` | –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã |
| `POST` | `/parse-blood-test` | –ü–∞—Ä—Å–∏–Ω–≥ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞ |
| `POST` | `/blood-results` | –†–∞—Å—á–µ—Ç SII –ø–æ –¥–∞–Ω–Ω—ã–º |

### üìù –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:

```bash
curl -X POST "http://localhost:8000/blood-results" \
     -H "Content-Type: application/json" \
     -d '{
       "neutrophils_absolute": 4.0,
       "platelets": 250.0,
       "lymphocytes_absolute": 2.0,
       "cancer_type": "C34"
     }'
```

## üè• –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏

| –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è | –¢–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ | –°—Ç–∞—Ç—É—Å |
|-------------|----------------|--------|
| **–ò–Ω–≤–∏—Ç—Ä–æ** | PDF, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è | ‚úÖ |
| **–û–ª–∏–º–ø** | PDF, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è | ‚úÖ |
| **InVivo** | PDF, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è | ‚úÖ |

## ü©∫ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ç–∏–ø—ã —Ä–∞–∫–∞

- **C34** - –†–∞–∫ –ª–µ–≥–∫–æ–≥–æ
- **C25** - –†–∞–∫ –ø–æ–¥–∂–µ–ª—É–¥–æ—á–Ω–æ–π –∂–µ–ª–µ–∑—ã
- **C16** - –†–∞–∫ –∂–µ–ª—É–¥–∫–∞
- **C15** - –†–∞–∫ –ø–∏—â–µ–≤–æ–¥–∞
- **C18** - –ö–æ–ª–æ—Ä–µ–∫—Ç–∞–ª—å–Ω—ã–π —Ä–∞–∫
- **C50** - –†–∞–∫ –º–æ–ª–æ—á–Ω–æ–π –∂–µ–ª–µ–∑—ã
- **C53** - –ì–∏–Ω–µ–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –æ–ø—É—Ö–æ–ª–∏
- **C22.0** - –ì–µ–ø–∞—Ç–æ—Ü–µ–ª–ª—é–ª—è—Ä–Ω–∞—è –∫–∞—Ä—Ü–∏–Ω–æ–º–∞

## üöÄ –î–µ–ø–ª–æ–π

### AWS (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π):
–ü—Ä–æ–µ–∫—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–µ–ø–ª–æ–∏—Ç—Å—è –≤ AWS ECS —á–µ—Ä–µ–∑ GitHub Actions –ø—Ä–∏ push –≤ `main` –≤–µ—Ç–∫—É.

### –†—É—á–Ω–æ–π –¥–µ–ø–ª–æ–π:
```bash
# –°–±–æ—Ä–∫–∞ –¥–ª—è production
docker build -t medtech-backend:prod .

# –ü—É—à –≤ ECR
docker tag medtech-backend:prod $ECR_REGISTRY/medtech-backend:latest
docker push $ECR_REGISTRY/medtech-backend:latest
```

## ü§ù –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### üîÑ –ü—Ä–æ—Ü–µ—Å—Å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:
1. –°–æ–∑–¥–∞–π—Ç–µ –≤–µ—Ç–∫—É –æ—Ç `main`
2. –í–Ω–µ—Å–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
3. –î–æ–±–∞–≤—å—Ç–µ —Ç–µ—Å—Ç—ã –¥–ª—è –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç—ã –ª–æ–∫–∞–ª—å–Ω–æ
5. –°–æ–∑–¥–∞–π—Ç–µ Pull Request

### üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∫–æ–¥—É:
- –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏ –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
- –°–æ–±–ª—é–¥–µ–Ω–∏–µ —Ç–∏–ø–∏–∑–∞—Ü–∏–∏ (mypy)
- –°–ª–µ–¥–æ–≤–∞–Ω–∏–µ —Å—Ç–∏–ª—é –∫–æ–¥–∞ (flake8)
- –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API (docstrings)

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License - —Å–º. [LICENSE](LICENSE) —Ñ–∞–π–ª.

## üë• –ö–æ–º–∞–Ω–¥–∞

–°–æ–∑–¥–∞–Ω–æ —Å ‚ù§Ô∏è –∫–æ–º–∞–Ω–¥–æ–π MedTech

---

**üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞:** –ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã, —Å–æ–∑–¥–∞–π—Ç–µ [issue](https://github.com/yourusername/medtech/issues) –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏. 